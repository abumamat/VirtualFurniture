<html>
<head>

<script type="text/javascript" src="../js/Library/jquery-1.8.0.min.js"></script>
<script type="text/javascript">
function checkusername()
{

var username =  document.getElementById('newusername').value;

if (username!=null&&username!='')
{
$.post('../php/checkusername.php', {username:username},function(data)
{
  
  if (data==1) alert('可用的用户名');
                       
  else alert('用户名不可用');
              

}); 
}
else
{
 
 alert('用户名不能为空');;
}

}

function clock(i)
{

document.getElementById('registerSucceed').textContent="注册成功,本窗口将在"+i+"秒后自动关闭!请在原页面登陆。";
if(i>0)setTimeout("clock("+(i-1)+");",1000); 
else 

{
	window.open('', '_self', '');
	window.close();
}
} 



function registration()
{
	
var username =  document.getElementById('newusername').value;
var password1 = document.getElementById('password1').value;	
var password2 = document.getElementById('password2').value;	


if (username!=null&&username!='')
{
$.post('../php/checkusername.php', {username:username},function(data)
{
  
  if (data==1)
  {
	
		if (password1==password2)
			
		{	
		    if (password1!=null&&password1!='')
			{
					$.post('../php/register.php', {username:username,password:password1,data:"empty"},function(data)
					{
						
					alert("注册成功");
					document.getElementById('registerArea').style.display="none";
					clock(3);
					
					}); 
		     }
			 else
			 {
				alert("密码不能为空");	 
			 }
		}
		else 
		{
		alert("两次输入的密码不一致");	
		}  
  }
                       
  else alert('用户名不可用');
              

}); 
}
else
{
 
 alert('用户名不能为空');;
}




		

}

function registerClear()
{
document.getElementById('newusername').value="";
document.getElementById('password1').value="";	
document.getElementById('password2').value="";		

}
</script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>注册</title>
</head>
<body>
<div id="registerArea" style="display:block">
<p>用户名：&nbsp;&nbsp;<input type="text" name="newusername" id="newusername" style="width:135" />
<input type="button" onClick="checkusername();" value="检测用户名" style="cursor: pointer;" /></p>
<p>密&nbsp;&nbsp;码：&nbsp;&nbsp;<input type="password" name="password1" id="password1" style="width:135" /></p>  
<p>确认密码：<input type="password" name="password1" id="password2" style="width:135" /></p>  
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" onClick="registration();" value="确认注册" style="cursor: pointer;" />&nbsp;<input type="button" onClick="registerClear();" value="清空" style="cursor: pointer;" /></p>
</div>
<div id="registerSucceed"></div>
</body>
</html>
